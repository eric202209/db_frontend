{"ast":null,"code":"import React,{useState,useEffect}from'react';import axios from'axios';import{Chart as ChartJS,LinearScale}from'chart.js';ChartJS.register(LinearScale);import Chart from'./Chart';import DataTable from'./DataTable';import FilterPanel from'./FilterPanel';import ComparisonView from'./ComparisonView';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Dashboard=()=>{const[data,setData]=useState({avgConsMake:[],topEfficient:[],fuelTypeDist:[],co2ByClass:[],bestSmog:[],consByTrans:[],co2RatingPct:[],topLowCo2:[]});const[filter,setFilter]=useState({});const[selectedChart,setSelectedChart]=useState('avgConsMake');const[comparisonItems,setComparisonItems]=useState([]);const[loading,setLoading]=useState(true);const[error,setError]=useState(null);useEffect(()=>{fetchData();},[filter]);const fetchData=async()=>{setLoading(true);setError(null);try{const response=await axios.get('/api/data',{params:filter});console.log('Fetched data:',response.data);// Log response data\n// Parse the response data\nconst parsedData={avgConsMake:response.data.avgConsMake.map(item=>({make:item.MAKE,avgCons:item.AVG_CONS})),topEfficient:response.data.topEfficient.map(item=>({make:item.MAKE,model:item.MODEL,combCons:item.COMB_CONS})),fuelTypeDist:response.data.fuelTypeDist.map(item=>({fuelType:item.FUEL_TYPE,count:item.COUNT_FT})),co2ByClass:response.data.co2ByClass.map(item=>({vehClass:item.VEH_CLASS,avgCo2:item.AVG_CO2})),bestSmog:response.data.bestSmog.map(item=>({make:item.MAKE,model:item.MODEL,smogRating:item.SMOG_RATING})),consByTrans:response.data.consByTrans.map(item=>({trans:item.TRANS,avgCons:item.AVG_CONS})),co2RatingPct:response.data.co2RatingPct.map(item=>({co2Rating:item.CO2_RATING,count:item.COUNT_CR,percentage:item.PERCENTAGE})),topLowCo2:response.data.topLowCo2.map(item=>({make:item.MAKE,avgCo2:item.AVG_CO2}))};setData(response.data);}catch(error){console.error('Error fetching data:',error);setError('Failed to fetch data. Please try again later.');}finally{setLoading(false);}};const chartTitles={avgConsMake:\"Average Consumption by Make\",co2ByClass:\"CO2 Emissions by Vehicle Class\",fuelTypeDist:\"Fuel Type Distribution\",bestSmog:\"Best Smog Ratings\",consByTrans:\"Consumption by Transmission\",co2RatingPct:\"CO2 Rating Percentages\",topLowCo2:\"Top Low CO2 Emitters\"};const handleComparisonToggle=item=>{setComparisonItems(prevItems=>prevItems.includes(item)?prevItems.filter(i=>i!==item):[...prevItems,item]);};if(loading){return/*#__PURE__*/_jsx(\"div\",{children:\"Loading...\"});}if(error){return/*#__PURE__*/_jsxs(\"div\",{children:[\"Error: \",error]});}return/*#__PURE__*/_jsxs(\"div\",{className:\"dashboard\",children:[/*#__PURE__*/_jsx(FilterPanel,{onFilterChange:setFilter}),/*#__PURE__*/_jsx(\"select\",{onChange:e=>setSelectedChart(e.target.value),children:Object.entries(chartTitles).map(_ref=>{let[key,value]=_ref;return/*#__PURE__*/_jsx(\"option\",{value:key,children:value},key);})}),data[selectedChart]&&data[selectedChart].length>0?/*#__PURE__*/_jsx(Chart,{data:data[selectedChart],title:chartTitles[selectedChart],type:selectedChart}):/*#__PURE__*/_jsx(\"div\",{children:\"No data available for the selected chart.\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"top-efficient\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Top Efficient Vehicles\"}),data.topEfficient&&data.topEfficient.length>0?/*#__PURE__*/_jsx(DataTable,{data:data.topEfficient,onComparisonToggle:handleComparisonToggle}):/*#__PURE__*/_jsx(\"p\",{className:\"no-data-message\",children:\"No data available for top efficient vehicles.\"})]}),comparisonItems.length>0&&/*#__PURE__*/_jsx(ComparisonView,{items:comparisonItems})]});};export default Dashboard;","map":{"version":3,"names":["React","useState","useEffect","axios","Chart","ChartJS","LinearScale","register","DataTable","FilterPanel","ComparisonView","jsx","_jsx","jsxs","_jsxs","Dashboard","data","setData","avgConsMake","topEfficient","fuelTypeDist","co2ByClass","bestSmog","consByTrans","co2RatingPct","topLowCo2","filter","setFilter","selectedChart","setSelectedChart","comparisonItems","setComparisonItems","loading","setLoading","error","setError","fetchData","response","get","params","console","log","parsedData","map","item","make","MAKE","avgCons","AVG_CONS","model","MODEL","combCons","COMB_CONS","fuelType","FUEL_TYPE","count","COUNT_FT","vehClass","VEH_CLASS","avgCo2","AVG_CO2","smogRating","SMOG_RATING","trans","TRANS","co2Rating","CO2_RATING","COUNT_CR","percentage","PERCENTAGE","chartTitles","handleComparisonToggle","prevItems","includes","i","children","className","onFilterChange","onChange","e","target","value","Object","entries","_ref","key","length","title","type","onComparisonToggle","items"],"sources":["D:/centennial/centennial 2024 summer/comp214/Assignment/group project/db_frontend/src/Dashboard.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport axios from 'axios';\r\nimport { Chart as ChartJS, LinearScale } from 'chart.js';\r\nChartJS.register(LinearScale);\r\nimport Chart from './Chart';\r\nimport DataTable from './DataTable';\r\nimport FilterPanel from './FilterPanel';\r\nimport ComparisonView from './ComparisonView';\r\n\r\nconst Dashboard = () => {\r\n    const [data, setData] = useState({\r\n        avgConsMake: [],\r\n        topEfficient: [],\r\n        fuelTypeDist: [],\r\n        co2ByClass: [],\r\n        bestSmog: [],\r\n        consByTrans: [],\r\n        co2RatingPct: [],\r\n        topLowCo2: []\r\n    });\r\n    const [filter, setFilter] = useState({});\r\n    const [selectedChart, setSelectedChart] = useState('avgConsMake');\r\n    const [comparisonItems, setComparisonItems] = useState([]);\r\n    const [loading, setLoading] = useState(true);\r\n    const [error, setError] = useState(null);\r\n\r\n    useEffect(() => {\r\n        fetchData();\r\n    }, [filter]);\r\n\r\n    const fetchData = async () => {\r\n        setLoading(true);\r\n        setError(null);\r\n        try {\r\n            const response = await axios.get('/api/data', { params: filter });\r\n            console.log('Fetched data:', response.data); // Log response data\r\n            \r\n            // Parse the response data\r\n            const parsedData = {\r\n                avgConsMake: response.data.avgConsMake.map(item => ({ make: item.MAKE, avgCons: item.AVG_CONS })),\r\n                topEfficient: response.data.topEfficient.map(item => ({ make: item.MAKE, model: item.MODEL, combCons: item.COMB_CONS })),\r\n                fuelTypeDist: response.data.fuelTypeDist.map(item => ({ fuelType: item.FUEL_TYPE, count: item.COUNT_FT })),\r\n                co2ByClass: response.data.co2ByClass.map(item => ({ vehClass: item.VEH_CLASS, avgCo2: item.AVG_CO2 })),\r\n                bestSmog: response.data.bestSmog.map(item => ({ make: item.MAKE, model: item.MODEL, smogRating: item.SMOG_RATING })),\r\n                consByTrans: response.data.consByTrans.map(item => ({ trans: item.TRANS, avgCons: item.AVG_CONS })),\r\n                co2RatingPct: response.data.co2RatingPct.map(item => ({ co2Rating: item.CO2_RATING, count: item.COUNT_CR, percentage: item.PERCENTAGE })),\r\n                topLowCo2: response.data.topLowCo2.map(item => ({ make: item.MAKE, avgCo2: item.AVG_CO2 }))\r\n            };\r\n            \r\n            setData(response.data);\r\n        } catch (error) {\r\n            console.error('Error fetching data:', error);\r\n            setError('Failed to fetch data. Please try again later.');\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    const chartTitles = {\r\n        avgConsMake: \"Average Consumption by Make\",\r\n        co2ByClass: \"CO2 Emissions by Vehicle Class\",\r\n        fuelTypeDist: \"Fuel Type Distribution\",\r\n        bestSmog: \"Best Smog Ratings\",\r\n        consByTrans: \"Consumption by Transmission\",\r\n        co2RatingPct: \"CO2 Rating Percentages\",\r\n        topLowCo2: \"Top Low CO2 Emitters\"\r\n    };\r\n\r\n    const handleComparisonToggle = (item) => {\r\n        setComparisonItems(prevItems => \r\n            prevItems.includes(item)\r\n                ? prevItems.filter(i => i !== item)\r\n                : [...prevItems, item]\r\n        );\r\n    };\r\n\r\n    if (loading) {\r\n        return <div>Loading...</div>;\r\n    }\r\n\r\n    if (error) {\r\n        return <div>Error: {error}</div>;\r\n    }\r\n\r\n    return (\r\n        <div className=\"dashboard\">\r\n            <FilterPanel onFilterChange={setFilter} />\r\n            <select onChange={(e) => setSelectedChart(e.target.value)}>\r\n                {Object.entries(chartTitles).map(([key, value]) => (\r\n                    <option key={key} value={key}>{value}</option>\r\n                ))}\r\n            </select>\r\n            {data[selectedChart] && data[selectedChart].length > 0 ? (\r\n                <Chart data={data[selectedChart]} title={chartTitles[selectedChart]} type={selectedChart} />            ) : (\r\n                <div>No data available for the selected chart.</div>\r\n            )}\r\n            <div className=\"top-efficient\">\r\n                <h2>Top Efficient Vehicles</h2>\r\n                {data.topEfficient && data.topEfficient.length > 0 ? (\r\n                    <DataTable\r\n                        data={data.topEfficient}\r\n                        onComparisonToggle={handleComparisonToggle}\r\n                    />\r\n            ) : (\r\n                <p className=\"no-data-message\">No data available for top efficient vehicles.</p>\r\n            )}\r\n            </div>\r\n            {comparisonItems.length > 0 && <ComparisonView items={comparisonItems} />}\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default Dashboard;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}